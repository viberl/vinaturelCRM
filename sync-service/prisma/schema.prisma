// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

model SalesRep {
  id         String   @id
  email      String   @unique
  firstName  String?
  lastName   String?
  customers  CustomerToSalesRep[]
  updatedAt  DateTime @updatedAt
  createdAt  DateTime @default(now())


  @@map("sales_rep")
}

model Customer {
  id         String   @id
  email      String
  company    String?
  firstName  String?
  lastName   String?
  street     String?
  city       String?
  zip        String?
  country    String?
  phone      String?
  latitude   Float?
  longitude  Float?
  customerNumber String?
  customerGroup  String?
  priceGroup     String?
  totalRevenue   Float?
  orderCount     Int?
  salesReps  CustomerToSalesRep[]
  updatedAt  DateTime @updatedAt
  createdAt  DateTime @default(now())


  @@map("customer")
  @@unique([email])
}

model CustomerToSalesRep {
  salesRep    SalesRep @relation(fields: [salesRepId], references: [id])
  salesRepId  String
  customer    Customer @relation(fields: [customerId], references: [id])
  customerId  String
  assignedAt  DateTime @default(now())

  @@id([salesRepId, customerId])
  @@map("sales_rep_customer")
}

model SyncSettings {
  id          Int       @id @default(1)
  lastSync    DateTime?
  updatedAt   DateTime  @updatedAt
  createdAt   DateTime  @default(now())


  @@map("sync_settings")
}

model CrmUser {
  id                 String   @id @default(uuid())
  email              String   @unique
  passwordHash       String
  firstName          String?
  lastName           String?
  salesRepEmail      String?
  salesRepId         String?
  role               String   @default("sales_rep")
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@map("crm_users")
}
